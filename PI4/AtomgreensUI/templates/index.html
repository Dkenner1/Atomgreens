{% extends "base.html" %}
{% block content %}
	<div class="wrapper">
		<!-- Page Header -->
		<div class="content-header">
			<div class="container-fluid">
				<h1>Dashboard</h1>
			</div>
		</div>

		 <!-- Main content -->
		<section id="trayButtons">
			<div class="container-fluid">
				<div class="d-flex justify-content-center">
					 <div class="container">
                        <div class="row row-cols-5">
                            <div class="col">
                                <div class="fullCard">
								    <div class="cardContent">
									    <div class="cardInfo">
								  		    <h6>Tray 1</h6>
										     <div class="progress">
                                                <div class="progress-bar" style="width:{{times[0]}}%">{{ times[0]}}%</div>
                                            </div>
                                            <button class="cardButton" onclick="document.location='trayinfo/1'">More info</button>
									    </div>
							  	    </div>
						        </div>
                            </div>

                            <div class="col">
                                <div class="fullCard">
								    <div class="cardContent">
									    <div class="cardInfo">
								  		    <h6>Tray 2</h6>
                                            {% if times[1] < 100 %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:{{times[4]}}%">{{times[1]}}%</div>
										    </div>
                                            {% else %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:100%">100%</div>
										    </div>
                                            {% endif %}
								  		    <button class="cardButton" onclick="document.location='trayinfo/2'">More info</button>
									    </div>
							  	    </div>
						        </div>
                            </div>

                            <div class="col">
                                <div class="fullCard">
								    <div class="cardContent">
									    <div class="cardInfo">
								  		    <h6>Tray 3</h6>
										    {% if times[2] < 100 %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:{{times[2]}}%">{{times[2]}}%</div>
										    </div>
                                            {% else %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:100%">100%</div>
										    </div>
                                            {% endif %}
								  		    <button class="cardButton" onclick="document.location='trayinfo/3'">More info</button>
									    </div>
							  	    </div>
						        </div>
                            </div>

                            <div class="col">
                                <div class="fullCard">
								    <div class="cardContent">
									    <div class="cardInfo">
								  		    <h6>Tray 4</h6>
                                            {% if times[3] < 100 %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:{{times[3]}}%">{{times[3]}}%</div>
										    </div>
                                            {% else %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:100%">100%</div>
										    </div>
                                            {% endif %}
								  		    <button class="cardButton" onclick="document.location='trayinfo/4'">More info</button>
									    </div>
							  	    </div>
						        </div>
                            </div>

                            <div class="col">
                                <div class="fullCard">
								    <div class="cardContent">
									    <div class="cardInfo">
								  		    <h6>Tray 5</h6>
                                            {% if times[4] < 100 %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:{{times[4]}}%">{{times[4]}}%</div>
										    </div>
                                            {% else %}
                                            <div class="progress">
  											    <div class="progress-bar" style="width:100%">100%</div>
										    </div>
                                            {% endif %}
								  		    <button class="cardButton" onclick="document.location='trayinfo/5'">More info</button>
									    </div>
							  	    </div>
						        </div>
                            </div>
                        </div>
                     </div>
				</div>
			</div>
		</section>
        <br>

        <div class="container-fluid">
            <div class="d-flex justify-content-center">
                <div class="row">
                    <div class="col">
                        <section id = "notifications">
                            <div class="content-header">
                                <div class="container-fluid">
                                    <h2>Notifications</h2>
                                </div>
                            </div>

                            <div class="container-fluid">
                            {%for trayId in range(0,5)%}
                                {% if times[(trayId | int) - 1] >= 100 %}
                                    <div class="alert alert-success">
                                        <p><b>Tray {{(trayId | int + 1)}} ready to harvest!</b></p>
                                    </div>
                                {% endif %}
                            {%endfor%}
                            </div>

                            <div class="container-fluid">
                                {% if status.water_level is defined and status.water_level == 0 %}
                                <div class="alert alert-warning">
                                    <p><b>Water Level is at low. Currently below 15%</b></p>
                                </div>
                                {% endif %}
                            </div>


                            {% for trayId in range(0,5) %}
                                <div class="container-fluid">
                                    <div class="alert alert-info">
                                        <p><b>Tray {{(trayId |int + 1)}} Weight: {{status.weight}} grams</b></p>
                                    </div>
                                </div>
                            {% endfor %}
                        <!--
                            <div class="container-fluid">
                                <div class="alert alert-info">
                                    {/% for i in range(0,5) %}
                                         <p><b>Tray 1 Weight: {/{status.weight}} grams</b></p>
                                         <p><b>Tray 2 Weight: {/{status.weight}} grams</b></p>
                                         <p><b>Tray 3 Weight: {/{status.weight}} grams</b></p>
                                         <p><b>Tray 4 Weight: {/{status.weight}} grams</b></p>
                                         <p><b>Tray 5 Weight: {/{status.weight}} grams</b></p>
                                    {/% endfor %}
                                 </div>
                            </div>
                        -->
                        </section>
                    </div>

                    <div class="col">
                         <section id="info">
                            <div class="container-fluid">
                                <div class="d-flex justify-content-center">
                                    <div class="container-fluid">
                                        <h2>Current Status</h2>
                                    </div>
                                    <table id="infoTable" >
                                        <tr>
                                            <th>PH</th>
                                            <th>PH Pump</th>
                                            <th>Heater</th>
                                            <th>External Humidity (%) </th>
                                        </tr>
                                        <tr>
                                            {% if status.ph is defined %}
                                            <td>{{ status.ph }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.ph_pump is defined %}
                                            <td>{{ status.ph_pump }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.heater is defined %}
                                            <td>{{ status.heater }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.humidity is defined %}
                                            <td>{{ status.humidity }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <th>EC</th>
                                            <th>EC Pump</th>
                                            <th>Temperature (â„‰) </th>
                                            <th>Humidity (%) </th>
                                        </tr>
                                        <tr>
                                            {% if status.EC is defined %}
                                            <td>{{ status.EC }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.ec_pump is defined %}
                                            <td>{{ status.ec_pump }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.temperature is defined %}
                                            <td>{{ status.temperature }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}

                                            {% if status.humidity is defined %}
                                            <td>{{ status.humidity }}</td>
                                            {% else %}
                                            <td> 0.0 </td>
                                            {% endif %}
                                        </tr>
                                    </table>
                                </div>
			                </div>
		                </section>
                    </div>
                </div>
            </div>
        </div>

        <section id="serviceMode">
            <div class="container-fluid">
                <div class="d-flex justify-content-center">
                    <button class="button cardButton" onclick="document.location='/service'">Service Mode</button>
                </div>
            </div>
        </section>

        <section id="refreshButton">
            <div class="container-fluid">
                <div class="d-flex justify-content-center">
                    <button class="button" onclick="go_home()">Refresh</button>
                </div>
            </div>
        </section>

        <section id="refreshTime">
            <div class="container-fluid">
                <div class="d-flex justify-content-center">
                    <p>Last Updated: <span id="datetime"></span></p>
                </div>
            </div>
        </section>
	</div>

{% endblock %}
{% block script %}


{% endblock %}

         

        